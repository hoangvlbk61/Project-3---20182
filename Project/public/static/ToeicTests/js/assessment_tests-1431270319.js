var AssessmentOperator=function(p,f,m,c){this.questionsList=p;this.totalMcqsCount=null;this.questionWeightsList=f;this.questionsSkillSubtypes=m;this.questionsPartNumbers=c;this.curQuestionIndex=this.curSubtypeIndex=null;this.curPartFinished=!1;this.prevSubtypeCorrectPercent=null;this.completionStatus=[];for(p=0;p<this.questionWeightsList.length;++p)this.completionStatus.push({});this.MAX_PREDICTED_OVER_COMPLETED_PERCENT_TO_PREDICT=.99;this.getQuestionsInCurrentSubtype=function(){if(null==this.curSubtypeIndex){if(0<this.questionsList.length)return this.curSubtypeIndex=0,this.questionsList[0];this.curSubtypeIndex=null;return[]}return this.questionsList[this.curSubtypeIndex]};this._countMcqsInQuestions=function(a){for(var b=0,e,n=0;n<=a;++n){e=this.questionsList[n];for(var g=0;g<e.length;++g)b=e[g]instanceof McqGroup?b+e[g].mcqs.length:b+1}return b};this.getTotalMcqsCount=function(){null==this.totalMcqsCount&&(this.totalMcqsCount=this._countMcqsInQuestions(this.questionsList.length-1));return this.totalMcqsCount};this.getPrevSubtypesMcqsCount=function(){return this._countMcqsInQuestions(this.curSubtypeIndex-1)};this.getCurrentPartNumber=function(){return this.questionsPartNumbers[this.curSubtypeIndex]};this.getCurrentSkillSubtype=function(){return this.questionsSkillSubtypes[this.curSubtypeIndex]};this.getMcqWeightsStatsInCurrentPart=function(){for(var a=0,b=0,e,n,g,d,c=this.curSubtypeIndex,l=this.questionsPartNumbers[c];;){n=this.questionWeightsList[c];g=this.completionStatus[c];for(var h=0;h<n.length;++h){e=n[h];d=g[h];for(var k=0;k<d.length;++k)a+=e*(d[k]?1:0),b+=e}c--;e=this.questionsPartNumbers[c];if(e!=l)break}return[a,b]};this.moveToNextSubtype=function(){if(null!=this.curSubtypeIndex&&this.curSubtypeIndex+1<this.questionsList.length)return this.curSubtypeIndex++,this.curPartFinished=!1,!0;this.curSubtypeIndex=null;return!1};this.canMoveToNextSubtype=function(){return null!=this.curSubtypeIndex&&this.curSubtypeIndex+1<this.questionsList.length?!0:!1};this.isCurrentPartFinished=function(){console.log("inside checking if current part finished, subtypeIndex = "+
this.curSubtypeIndex);console.log("questions part numbers");console.log(this.questionsPartNumbers);return this.curSubtypeIndex==this.questionsPartNumbers.length-1?!0:this.questionsPartNumbers[this.curSubtypeIndex]==this.questionsPartNumbers[this.curSubtypeIndex+1]?!1:!0};this.summarizeAnswersResults=function(a){for(var b=0;b<a.length;++b)if(!a[b])return!1;return!0};this.getAndMoveToNextQuestionIndex=function(a){console.log("assessment: get next quest index. Answer results = ");console.log(a);if(null==this.curQuestionIndex){null==this.prevSubtypeCorrectPercent?0<this.questionsList.length?(this.curSubtypeIndex=0,a=Math.floor(this.questionsList[this.curSubtypeIndex].length/2)):a=null:a=this._getNextQuestionIndexBasedOnPrevCorrectPercent();this.curQuestionIndex=a;var b=!1}else{b=this.completionStatus[this.curSubtypeIndex];b[this.curQuestionIndex]=a;console.log("questions status = ");console.log(b);var e=this._predictRemainingAnswersSameSubtype();b=e[1];e[0]?(this.curPartFinished=this.isCurrentPartFinished(),a=null,this.prevSubtypeCorrectPercent=b,b=this.curSubtypeIndex+1<this.questionsList.length?!0:!1):(b=!1,a=this.summarizeAnswersResults(a)?this._getHarderUnAskedQIndex():this._getEasierUnAskedQIndex());this.curQuestionIndex=a}console.log("returned qindex = "+a+", to next part? = "+b);return[a,b]};this._predictRemainingAnswersSameSubtype=function(){for(var a=this.questionWeightsList[this.curSubtypeIndex],b=this.completionStatus[this.curSubtypeIndex],e,c=null,g=null,d=a.length-1;0<=d&&!(d in b&&((e=this.summarizeAnswersResults(b[d]))?null===c&&(c=d):null==g&&(g=d),null!==c&&null!==g));--d);console.log("highest wrong index = "+g+", highest correct index = "+c);var f=0,l=0,h=0,k=0;for(d=0;d<a.length;++d)d in b?(e=this.summarizeAnswersResults(b[d]))?f++:l++:null!=c&&d<c?k++:null!=g&&d>g&&h++;console.log("sum of all counts = "+(f+k+l+h));if(f+k+l+h==a.length){console.log("correct ratio = "+k/f);console.log("wrong ratio = "+h/l);if((0==f||k/f<=this.MAX_PREDICTED_OVER_COMPLETED_PERCENT_TO_PREDICT)&&(0==l||h/l<=this.MAX_PREDICTED_OVER_COMPLETED_PERCENT_TO_PREDICT)){for(d=0;d<a.length;d++)d in b||(d<c?b[d]=!0:d>g&&(b[d]=!1));return[!0,(k+f)/a.length]}console.log("dont satisfy % condition")}return[!1,null]};this._searchForwardUnAskedQIndex=function(){for(var a=this.questionWeightsList[this.curSubtypeIndex],b=this.completionStatus[this.curSubtypeIndex],c=this.curQuestionIndex+1;c<a.length;++c)if(!(c in b))return c;return null};this._searchBackwardsUnAskedQIndex=function(){for(var a=this.completionStatus[this.curSubtypeIndex],b=this.curQuestionIndex-1;0<=b;--b)if(!(b in a))return b;return null};this._getHarderUnAskedQIndex=function(){var a=this._searchForwardUnAskedQIndex();null==a&&(a=this._searchBackwardsUnAskedQIndex());return a};this._getEasierUnAskedQIndex=function(){var a=this._searchBackwardsUnAskedQIndex();null==a&&(a=this._searchForwardUnAskedQIndex());return a};this._getNextQuestionIndexBasedOnPrevCorrectPercent=function(){console.log("get next quest index based on prev correct % = "+this.prevSubtypeCorrectPercent);var a=this.questionsList[this.curSubtypeIndex].length;return 0==a?null:1==a%2?Math.floor(a/2):.6<=this.prevSubtypeCorrectPercent?a/2:a/2-1}};$(document).ready(function(){$("#set-goal-form").submit(checkInputTargetScore);$("#set-goal-form #entry-score-input").change(function(){$(this).val()!=originEntryScore?$("#assessment-test-result-notice").fadeOut():$("#assessment-test-result-notice").fadeIn()})});function checkInputTargetScore(p){var f="",m="",c=originEntryScore;if(null==c)if(c=$("#entry-score-input").val())if(/^\d+$/.test(c)){if(c=parseInt(c),0>c||900<c)f="\u0110i\u1ec3m TOEIC hi\u1ec7n nay: ph\u1ea3i n\u0103m trong kho\u1ea3ng t\u1eeb 0 \u0111\u1ebfn 900"}else f="\u0110i\u1ec3m hi\u1ec7n nay ph\u1ea3i l\u00e0 s\u1ed1 nguy\u00ean d\u01b0\u01a1ng.";else f="B\u1ea1n ch\u01b0a nh\u1eadp \u0111i\u1ec3m hi\u1ec7n nay c\u1ee7a m\u00ecnh";(c=$("#target-score-input").val())?/^\d+$/.test(c)?(c=parseInt(c),990<c&&(m="\u0110i\u1ec3m TOEIC m\u1ee5c ti\u00eau: ph\u1ea3i n\u0103m trong kho\u1ea3ng t\u1eeb 100 \u0111\u1ebfn 990")):m="\u0110i\u1ec3m TOEIC m\u1ee5c ti\u00eau: ph\u1ea3i l\u00e0 m\u1ed9t s\u1ed1 trong kho\u1ea3ng t\u1eeb 100 \u0111\u1ebfn 990":m="B\u1ea1n ch\u01b0a nh\u1eadp \u0111i\u1ec3m TOEIC m\u1ee5c ti\u00eau";$(".entry-score-error").html(f);$(".target-score-error").html(m);$("#deadline-error").html("");if(f||m)return p.preventDefault(),!1;$(".set-target-btn").html("\u0110ang t\u1ea1o L\u1ed9 tr\u00ecnh h\u1ecdc...")};