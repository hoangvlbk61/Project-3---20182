var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,a,c){b instanceof String&&(b=String(b));for(var d=b.length,e=0;e<d;e++){var f=b[e];if(a.call(c,f,e,b))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,c){b!=Array.prototype&&b!=Object.prototype&&(b[a]=c.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,a,c,d){if(a){c=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var e=b[d];e in c||(c[e]={});c=c[e]}b=b[b.length-1];d=c[b];a=a(d);a!=d&&null!=a&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:a})}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");function ClassConsts(){}ClassConsts.CORRECT_ANSWER_CLS="correct-answer";ClassConsts.CORRECT_ANSWER_COLOR_CLS="correct-answer-color";ClassConsts.INCORRECT_ANSWER_CLS="incorrect-answer";ClassConsts.INCORRECT_ANSWER_COLOR_CLS="incorrect-answer-color";function ValueConsts(){}ValueConsts.BLANK_SYMBOL="_____";function MsgConsts(){}MsgConsts.CLICK_TO_REPLAY_OPTION="Nghe l\u1ea1i option";MsgConsts.CLICK_TO_PLAY_OPTION="Nghe option";MsgConsts.OPTION="Option";MsgConsts.PLAYING="PLAYING &#9658;";MsgConsts.YOUR_SCORE="Your Score";MsgConsts.TRANSLATE_OPTION="D\u1ecbch c\u00e2u tr\u00ean";MsgConsts.NO_OPTION_SELECTED="B\u1ea1n \u0111\u00e3 kh\u00f4ng ch\u1ecdn \u0111\u00e1p \u00e1n n\u00e0o cho c\u00e2u h\u1ecfi n\u00e0y";MsgConsts.YOU_CAN_PLAY_AUDIO="B\u1ea1n s\u1ebd c\u00f3 th\u1ec3 play audio";MsgConsts.AUDIO_WILL_BE_PLAYED="Audio s\u1ebd b\u1eaft \u0111\u1ea7u play";MsgConsts.NEXT_MCQ="Next";MsgConsts.NEXT_QUIZ="New Quiz";MsgConsts.REDO_QUIZ="L\u00e0m l\u1ea1i";MsgConsts.CLICK_TO_VIEW_VOCAB_DEF="K\u00edch \u0111\u1ec3 xem th\u00f4ng tin c\u1ee7a t\u1eeb";MsgConsts.NO_MORE_GRAMMAR_ADDITIONAL_EXS="<h2>Kh\u00f4ng c\u00f2n c\u00e2u luy\u1ec7n t\u1eadp n\u00e0o cho ch\u1ee7 \u0111\u1ec1 ng\u1eef ph\u00e1p n\u00e0y</h2><a href='/ngu-phap-tieng-anh/dashboard/' class='submit-btn oval-btn' style='display: inline-block'>H\u1ecdc ti\u1ebfp m\u1ed9t ch\u1ee7 \u0111i\u1ec3m ng\u1eef ph\u00e1p kh\u00e1c</a>";MsgConsts.EXPLANATION_REQUEST="";function TimeConsts(){}TimeConsts.TEST_DURATION_EXTRA_SECS_FOR_SINGLE_MCQS=8;TimeConsts.TEST_DURATION_EXTRA_EXTRA_SECS_FOR_PART_1_2=5;TimeConsts.TEST_DURATION_EXTRA_SECS_FOR_MCQ_GROUPS=20;TimeConsts.TIME_CIRLCE_DEFAULT_SETTINGS={start:!1,direction:"Clockwise",count_past_zero:!1,fg_width:.1,circle_bg_color:"#999999",time:{Days:{show:!1},Hours:{show:!1,text:"Hours",color:"#9A3334"},Minutes:{show:!1,text:"Minutes",color:"#333"},Seconds:{show:!0,text:"Seconds",color:"#FF3333"}}};function QuizConsts(){}QuizConsts.MAX_MCQS_EACH_SIDE_TO_FETCH_NEXT=1;function PathConsts(){}PathConsts.PRACTICE_TESTS_CSS_DIR="../../static/ToeicTests/css/PracticeTests/index.html";PathConsts.PRACTICE_TESTS_IMAGES_DIR="../../static/ToeicTests/images/Practice_Tests/index.html";PathConsts.CORRECT_ANS_SOUND_URL="../../static/ToeicTests/audios/correct_answer_sound.mp3";PathConsts.WRONG_ANS_SOUND_URL="../../static/ToeicTests/audios/wrong_answer_sound.mp3";function CssConsts(){}CssConsts.CSS_LINK_P2='<link rel="stylesheet" class="part-stylesheet" href="../../static/ToeicTests/css/PracticeTests/practice-test-part2-styles-1431270319.css"  />';CssConsts.CSS_LINK_P5='<link rel="stylesheet" class="part-stylesheet" href="../../static/ToeicTests/css/PracticeTests/practice-test-part5-styles-1431270319.css"  />';CssConsts.CSS_LINK_MCQGROUP_PARTS='<link rel="stylesheet" class="part-stylesheet" href="../../static/ToeicTests/css/PracticeTests/practice-test-mcqgroup-styles-1431270319.css"  />';CssConsts.CSS_LINK_P2_MOBILE='<link rel="stylesheet" class="part-stylesheet" href="../../static/ToeicTests/css/PracticeTests/practice-test-part2-styles-mobile-1431270319.css"  />';CssConsts.CSS_LINK_P5_MOBILE='<link rel="stylesheet" class="part-stylesheet" href="../../static/ToeicTests/css/PracticeTests/practice-test-part5-styles-mobile-1431270319.css"  />';CssConsts.CSS_LINK_MCQGROUP_PARTS_MOBILE='<link rel="stylesheet" class="part-stylesheet" href="../../static/ToeicTests/css/PracticeTests/practice-test-mcqgroup-styles-mobile-1431270319.css"  />';CssConsts.PART_STYLESHEET_CLASS_NAME="part-additional-stylesheet";CssConsts.PART_STYLESHEET_MOBILE_CLASS_NAME="part-additional-mobile-stylesheet";var quizOperator,assessmentOperator,questionOperator,timer=null,timeInterval=null;disableLog&&(console.log=function(){});var preload=new createjs.LoadQueue(!1);$(document).on("change",".speed-adjustment-wrapper .speed-select",function(){var b=$(this).find(":selected").val();$(this).closest(".speed-adjustment-wrapper").siblings("audio").prop("playbackRate",b)});var Mcq=function(b){this.isMcqGroup=!1;this.id=b.id;this.testDuration=b.testDuration;var a=b.question;this.question=a[0];this.questionTrans=a[1];a=b.answer;this.answer=a[0];this.answerExp=a[1];this.videoExpURL=b.video_exp_url;this.imageUrl=b.image;this.hintImageUrl=b.hintImage;a=b.audio;this.audioUrl=a[0];1==partNumber||5==partNumber?this.optionAudios={A:a[1],B:a[2],C:a[3],D:a[4]}:2==partNumber&&(this.speakerAAudioUrl=a[1],this.optionAudios={A:a[2],B:a[3],C:a[4]});this.optionTranscripts={A:b.optionA,B:b.optionB,C:b.optionC};2!=partNumber&&(this.optionTranscripts.D=b.optionD);this.grammarLinksInfo=b.grammar_links_info;this.annotatedVocabsInfo=b.annotatedVocabs;this.learnerQuestionsCount=b.learnerQuestionsCount;this.didWronglyTheLastTime=b.did_wrongly_the_last_time;""!==this.imageUrl&&null!==this.imageUrl&&preload.loadFile(this.imageUrl);""!==this.audioUrl&&null!=this.audioUrl&&preload.loadFile(this.audioUrl);if("undefined"!==typeof this.optionAudios)for(var c in this.optionAudios)this.optionAudios.hasOwnProperty(c)&&preload.loadFile(this.optionAudios[c]);"undefined"!==typeof this.speakerAAudioUrl&&preload.loadFile(this.speakerAAudioUrl)},McqGroup=function(b){console.log("create mcq group, part number = "+partNumber+", id = "+b.id);this.isMcqGroup=!0;this.id=b.id;this.videoExpURL=b.video_exp_url;this.reading_texts=[];for(var a=0;a<b.reading_texts.length;a++)this.reading_texts.push(b.reading_texts[a]);this.testDuration=b.testDuration;this.audioUrl=b.audio;this.imageUrl=b.image;this.learnerQuestionsCount=b.learnerQuestionsCount;this.didWronglyTheLastTime=b.did_wrongly_the_last_time;this.mcqs=[];for(a=0;a<b.mcqDatas.length;a++)this.mcqs.push(new Mcq(b.mcqDatas[a]));null!=this.audioUrl&&preload.loadFile(this.audioUrl)},QuizOperator=function(b){this.partNumber=b;this.skillSubtype=skillSubtype;this.grammarCategoryCode=grammarCategoryCode;this.addThisQuizScore=this.customerPublicQuizScore=this.publicMcqDataCode=this.publicMcqDataDesc=this.publicMode=null;isAssessmentTest||(this.questionsPerQuiz=3==b||4==b||6<=b?3:10);this.testResultId=this.customerTotalScore=null;this.questions=[];this.currentQuestionIndex=null;this.askedQuestions=[];this.scores=[];this.correctAnswersCount=0;this._allMcqIds=[];this.translateLabelClicked=!1;this.startQuiz=function(){console.log("quizOperator.startQuiz with part number = "+b);$(".part-quiz").hide();$("link."+CssConsts.PART_STYLESHEET_CLASS_NAME).remove();3==b||4==b||6==b||7==b||8==b?($("#part-mcqgroup-quiz").show(),$("head").append(CssConsts.CSS_LINK_MCQGROUP_PARTS),isMobileBrowser&&$("head").append(CssConsts.CSS_LINK_MCQGROUP_PARTS_MOBILE)):($("#part"+b+"-quiz").show(),2==b?($("head").append(CssConsts.CSS_LINK_P2),isMobileBrowser&&$("head").append(CssConsts.CSS_LINK_P2_MOBILE)):5==b&&($("head").append(CssConsts.CSS_LINK_P5),isMobileBrowser&&$("head").append(CssConsts.CSS_LINK_P5_MOBILE)));$(".quiz-result").hide();quizOperator.publicMode?$(".quiz-name").html(quizOperator.publicMcqDataDesc):$(".quiz-name .part-number").html(quizOperator.partNumber);$(".quiz-progress").progressbar({max:quizOperator.questionsPerQuiz});$(".quiz, .quiz-progress").show();if(quizOperator.publicMode||isAssessmentTest){var a;if(quizOperator.publicMode){var c=publicMcqInfo.publicMcqData;for(a=0;a<c.length;++a)quizOperator.appendQuestionData(c[a]);console.log("All public mode questions = "+quizOperator.printMcqs());quizOperator.questionsPerQuiz=quizOperator.questions.length;a=0}else{c=assessmentOperator.getQuestionsInCurrentSubtype();for(a=0;a<c.length;++a)quizOperator.appendQuestionObj(c[a]);console.log("All assessment questions in current subtype = "+quizOperator.printMcqs());quizOperator.questionsPerQuiz=assessmentOperator.getTotalMcqsCount();a=assessmentOperator.getAndMoveToNextQuestionIndex()[0]}$(".quiz-progress").progressbar("option","max",quizOperator.questionsPerQuiz);quizOperator.setCurrentQuestionIndex(a);questionOperator=new QuestionOperator;questionOperator.showQuestions()}else quizOperator.fetchQuestionsFromServer(quizOperator._addMcqsFromServerAndShowFirstMcq);$(".next-mcq-button").off("click");$(".next-mcq-button").click(function(){if(1==quizOperator.partNumber||2==quizOperator.partNumber||3==quizOperator.partNumber||4==quizOperator.partNumber){if(questionOperator.stopAllPlayingSounds(),1==quizOperator.partNumber||3==quizOperator.partNumber||4==quizOperator.partNumber)$("#part1-quiz img, .p34-image").attr("src",""),$(".quiz img").off("load")}else 5==quizOperator.partNumber&&(questionOperator.stopAllPlayingSounds(),$("#part5-quiz .transcript, #part5-quiz .translation").off(),$("#part5-quiz .annotated-vocabs-wrapper").hide());if(3==quizOperator.partNumber||4==quizOperator.partNumber||6==quizOperator.partNumber||7==quizOperator.partNumber||8==quizOperator.partNumber)$("#part-mcqgroup-quiz .mcqs-wrapper").prop("disabled",!1),$("#part-mcqgroup-quiz .mcqs-wrapper").html("");quizOperator.markCurrentQuestAsAskedAndSetNextQuestIndex();isAssessmentTest&&assessmentOperator.curPartFinished&&(weightsInfo=assessmentOperator.getMcqWeightsStatsInCurrentPart(),correctCount=weightsInfo[0],totalCount=weightsInfo[1],quizOperator.sendAssessmentPartScoreToServer(correctCount,totalCount));0<$(".hint-wrapper").length&&($(".hint-wrapper").hide(),$(".hint-image").attr("src","").hide());$(".did-wrongly-the-last-time-msg").hide();questionOperator=new QuestionOperator;questionOperator.showQuestions()})};this.printMcqs=function(){for(var a=[],b=0;b<this.questions.length;++b)a.push(this.questions[b].id);return"Current Mcqs = "+a.join(", ")};this.appendQuestionData=function(a){null!=a&&-1===$.inArray(a.id,this._allMcqIds)&&(a.isMcqGroup?this.questions.push(new McqGroup(a)):this.questions.push(new Mcq(a)),this._allMcqIds.push(a.id))};this.appendQuestionObj=function(a){null!=a&&-1===$.inArray(a.id,this._allMcqIds)&&this.questions.push(a);this._allMcqIds.push(a.id)};this.prependQuestions=function(a){null!==a&&-1===$.inArray(a.id,this._allMcqIds)&&(a.isMcqGroup?this.questions.unshift(new McqGroup(a)):this.questions.unshift(new Mcq(a)),this._allMcqIds.push(a.id),this.currentQuestionIndex+=1)};this.setCurrentQuestionIndex=function(a){this.currentQuestionIndex=a;this.currentQuestionIndex>=this.questions.length?this.currentQuestionIndex=this.questions.length-1:0>this.currentQuestionIndex&&(this.currentQuestionIndex=0)};this.getNextQuestion=function(){var a=this.publicMode?this.currentQuestionIndex+1:quizOperator.currentQuestionIndex;return null!==a?(a>=this.questions.length?a=this.questions.length-1:0>a&&(a=0),this.getQuestion(a)):null};this.getCurrentQuestion=function(){return this.getQuestion(this.currentQuestionIndex)};this.getQuestion=function(a){return null!==a&&0<=a&&a<this.questions.length?this.questions[a]:null};this.getCurrentQuestionIndexInPracticeTest=function(){return this.askedQuestions.length};this.needsMoreQuestions=function(){return isAssessmentTest?!1:this.currentQuestionIndex+QuizConsts.MAX_MCQS_EACH_SIDE_TO_FETCH_NEXT>=this.questions.length?!0:!1};this.getQuizScore=function(){for(var a=quizOperator.scores,b=0,d=0;d<a.length;++d)b+=a[d];return b};this.getVideoExpHtml=function(a){var b="";""!=a&&null!=a&&(b='<div class="embed-responsive embed-responsive-16by9 video-explanation"><iframe width="560" height="315" src="'+
a+'?rel=0&controls=1&modestbranding=1&showinfo=1" frameborder="0" gesture="media" allow="encrypted-media" allowfullscreen></iframe></div>');return b};this.getGrammarLinksHtml=function(a){var b="";if(0<a.length){for(var d,e=0;e<a.length;++e)d=a[e],b+='<li><a href="'+d[0]+'?r=ptest" target="_blank">'+d[1]+"</a></li>";b='<div class="grammar-links-wrapper"><div class="title">H\u1ecdc th\u00eam v\u1ec1 nh\u1eefng \u0111i\u1ec3m ng\u1eef ph\u00e1p li\u00ean quan</div>'+('<ol class="grammar-links">'+b+"</ol>")+
"</div>"}return b};this.countAskedMcqs=function(){for(var a,b=0,d=0;d<quizOperator.askedQuestions.length;++d)a=quizOperator.askedQuestions[d],b=a.isMcqGroup?b+a.mcqs.length:b+1;return b};this.showQuizResultSummary=function(){console.log("enter show quiz summary");$(".next-mcq-button").off("click");if(quizOperator.publicMode){$(".mcq-feedback-button, .mcq-notes-button, .ask-button").hide();$(".quiz-result .quiz-title").html(quizOperator.publicMcqDataDesc);$(".quiz-result .mcqs-count").html(quizOperator.countAskedMcqs());$(".quiz-result .part-number").html(quizOperator.partNumber);$(".quiz-result .correct-answers-count").html(quizOperator.correctAnswersCount);var a=quizOperator.getQuizScore();$(".quiz-result .score-gained").html(a);$(".quiz-result .like-quiz-wrapper, .quiz-result .create-learning-goal").show();quizOperator.isGrammarApp&&a>=quizOperator.minGrammarScoreToPass?($(".quiz-result .grammar-exs-msg.failure").hide(),$(".quiz-result .grammar-exs-msg.success").show()):($(".quiz-result .grammar-exs-msg.success").hide(),$(".quiz-result .grammar-exs-msg.failure").show());var c=quizOperator.scoreCounts;0<=a?c[a]+=1:c[-1]+=1;console.log("public score stats:");console.log(c);c3.generate({bindto:"#result-graph",size:{width:400,height:285},data:{type:"pie",columns:[["lowerZeroCount",c[-1]],["equalZeroCount",c[0]],["equalOneCount",c[1]],["equalTwoCount",c[2]],["equalThreeCount",c[3]]],names:{lowerZeroCount:"Scores < 0",equalZeroCount:"Score = 0",equalOneCount:"Scores = 1",equalTwoCount:"Scores = 2",equalThreeCount:"Scores = 3"},legend:{inset:{anchor:"top-right",x:20,y:10,step:2}}}});$(".quiz-result .result-graph-wrapper").show();quizOperator.sendQuizScoreToServer();$(".quiz, .quiz-header").hide();$(".quiz-result").show();goToClassByScroll("quiz-title");isAssessmentTest||(quizOperator.publicMode?($(".next-mcq-button .next-label").html(MsgConsts.REDO_QUIZ),$(".next-mcq-button").click(function(){window.location.reload(!1)})):($(".next-mcq-button .next-label").html(MsgConsts.NEXT_MCQ),$(".next-mcq-button").click(function(){isPayingCustomer?(quizOperator=new QuizOperator(b),quizOperator.startQuiz()):window.location.href="/de-luyen-tap/toeic-"+quizOperator.skillSubtype+"/?r=practice-part-"+quizOperator.partNumber})))}else window.location.href="/de-luyen-tap/result/"+quizOperator.testResultId+"/?r=ptest"};this.markCurrentQuestAsAskedAndSetNextQuestIndex=function(){var a=this.getCurrentQuestion(),b=[];if(a.isMcqGroup){var d=questionOperator.customerAnswers;for(var e,f=0;f<a.mcqs.length;f++)e=a.mcqs[f],d[f]==e.answer?(quizOperator.correctAnswersCount+=1,b.push(!0)):b.push(!1)}else{if(d=questionOperator.customerAnswers==a.answer)quizOperator.correctAnswersCount+=1;b.push(d)}quizOperator.scores.push(questionOperator.getQuestionScoreResult());isAssessmentTest?(quizOperator.askedQuestions.push(a),b=assessmentOperator.getAndMoveToNextQuestionIndex(b)[0],quizOperator.setCurrentQuestionIndex(b),console.log("current part finished ? "+assessmentOperator.curPartFinished)):(quizOperator.questions.splice(this.currentQuestionIndex,1),b=this.currentQuestionIndex,quizOperator.setCurrentQuestionIndex(b),quizOperator.askedQuestions.push(a));1!=quizOperator.partNumber&&2!=quizOperator.partNumber&&3!=quizOperator.partNumber&&4!=quizOperator.partNumber||soundManager.destroySound(a.audioUrl);console.log(this.printMcqs())};this.resetQuizVars=function(){this.testResultId=null;this.questions=[];this.currentQuestionIndex=null;this.askedQuestions=[]};this.sendAssessmentPartScoreToServer=function(a,b){console.log("record skill score: test id = "+quizOperator.testResultId+
", subtype = "+quizOperator.skillSubtype+", correct = "+a+", total = "+b);var c="../../kiem-tra-dau-vao/record-skill-score/index.html";c=isAssessmentListening?c+"listening/":c+"reading/";$.ajax({url:c,type:"POST",dataType:"json",data:{practiceTestResultId:quizOperator.testResultId,skillSubtype:quizOperator.skillSubtype,correctCount:a,totalCount:b},success:function(a){console.log("Ajax return: result from record assessment skill score = "+a);null!=quizOperator.getCurrentQuestion()||assessmentOperator.canMoveToNextSubtype()||(console.log("end of assessment test"),a="../../kiem-tra-dau-vao/index.html",a=isAssessmentListening?a+"?r=listening-assessment":a+"?r=reading-assessment",window.location.href=a)},error:function(a,b,c){console.log(a.responseText)}})};this.sendQuizScoreToServer=function(){var a=quizOperator.getQuizScore();$.ajax({url:"/compete/save-score/",type:"POST",dataType:"json",data:{dataCode:quizOperator.publicMcqDataCode,quizScore:a},success:function(a){},error:function(a,b,e){console.log(a.responseText)}})};this.sendCurrentQuestionAnswerToServer=function(){var a=quizOperator.getCurrentQuestion(),b=quizOperator.skillSubtype,d=questionOperator.customerAnswers;quizOperator.getCurrentQuestionIndexInPracticeTest();var e=questionOperator.getQuestionScoreResult(),f=[];if(a.isMcqGroup){var g=!0;for(var h,k=0;k<a.mcqs.length;k++)h=a.mcqs[k],d[k]!=h.answer&&(g=!1),f.push(h.id)}else f=[a.id],g=d[0]==a.answer;for(k=0;k<d.length;k++)null===d[k]&&(d[k]="");a={isAssessmentTest:isAssessmentTest,isLearningMode:isLearningMode,ids:f,skillSubtype:b,practiceTestResultId:quizOperator.testResultId,customerAnswers:d,score:e};console.log("Submit answer:");console.log(a);$.ajax({url:"/de-luyen-tap/mark-mcq-result/",type:"POST",dataType:"json",data:a,success:function(a){quizOperator.needsMoreQuestions()&&quizOperator.fetchQuestionsFromServer(quizOperator._addMcqsFromServer,[g])},error:function(a,b,c){console.log(a.responseText)}})};this._addMcqsFromServerAndShowFirstMcq=function(a,b){quizOperator.customerTotalScore=a.totalScore;b=quizOperator.questions.length;a=a.questions;for(var c,e=0;e<a.length;++e)c=a[e],quizOperator.appendQuestionData(c);0==quizOperator.questions.length?null==quizOperator.grammarCategoryCode?window.location.href="/de-luyen-tap/amazed/?r=practice-test&skill="+quizOperator.skillSubtype+"&category="+quizOperator.grammarCategoryCode:$("#part5-quiz").html(MsgConsts.NO_MORE_GRAMMAR_ADDITIONAL_EXS):(quizOperator.setCurrentQuestionIndex(0),console.log("add 1st batch questions from server. # questions added = "+(quizOperator.questions.length-b)),console.log(quizOperator.printMcqs()),questionOperator=new QuestionOperator,questionOperator.showQuestions())};this._addMcqsFromServer=function(a,b){console.log("add questions from server.  question answered correctly = "+b[0]);b=quizOperator.questions.length;a=a.questions;for(var c,e=0;e<a.length;++e)c=a[e],quizOperator.appendQuestionData(c);console.log("# questions added = "+(quizOperator.questions.length-b));console.log(quizOperator.printMcqs())};this.fetchQuestionsFromServer=function(a,b){var c=null==quizOperator.grammarCategoryCode?"":quizOperator.grammarCategoryCode;console.log("Fetch next questions, skill subtype = "+quizOperator.skillSubtype+", grammar category = "+c+", result id = "+quizOperator.testResultId);$.ajax({url:"/de-luyen-tap/get-mcq-data/",type:"POST",data:{isLearningMode:isLearningMode,skillSubtype:quizOperator.skillSubtype,grammarCategoryCode:c,practiceTestResultId:quizOperator.testResultId},dataType:"json",success:function(c){console.log("returned data = ");console.log(c);var d=c.practiceTestResultId;console.log("from server: practice result id = "+
d);if(null===quizOperator.testResultId||d!=quizOperator.testResultId)null!==quizOperator.testResultId&&quizOperator.resetQuizVars(),quizOperator.testResultId=d;a(c,b)},error:function(a,b,c){}})}};function QuestionOperator(){this._customerScore=null;this.customerAnswers=[];this.wrongAnswers=[];this.part1ImageLoaded=this.timeOut=this.autoShowAnswer=this.audioFinished=this.questionAnswered=!1;this.part1QuizAudioObj=null;this.stopAudioById=function(b){b=soundManager.getSoundById(b);"undefined"!==typeof b&&null!=b&&b.stop()};this.answerQuestion=function(){this.autoShowAnswer=!0;var b=quizOperator.getCurrentQuestion();b.isMcqGroup?(console.log("answer question: click submit-answers"),$(".submit-answers").click()):$(".options li.option[value='"+b.answer+"']").click()};this.getQuestionScoreResult=function(){if(null!==this._customerScore)return this._customerScore;var b,a=quizOperator.getCurrentQuestion();if(a.isMcqGroup)for(var c=b=0;c<a.mcqs.length;c++){var d=a.mcqs[c];null===this.customerAnswers[c]?--b:this.customerAnswers[c]==d.answer[0]&&(b+=1)}else b=null===this.customerAnswers[0]?-1:this.customerAnswers[0]==a.answer?1:0;return this._customerScore=b};this.stopAllPlayingSounds=function(){console.log("stop all playing sounds");var b=quizOperator.getCurrentQuestion();this.stopAudioById(b.audioUrl);this.audioFinished=!0;if(2==quizOperator.partNumber)questionOperator.stopAudioById(b.speakerAAudioUrl);else if(3==quizOperator.partNumber||4==quizOperator.partNumber)$("#part-mcqgroup-quiz .audio-player-wrapper audio").trigger("pause"),null!==timeInterval&&clearInterval(timeInterval);b=b.optionAudios;var a;for(a in b)if(b.hasOwnProperty(a)){this.stopAudioById(b[a]);var c=$(".options li.option[value='"+a+"']");c.html()==$(document.createElement("div")).html(MsgConsts.PLAYING).text()&&c.html(MsgConsts.CLICK_TO_REPLAY_OPTION+" "+a)}isLearningMode&&$.each($(".part-quiz .audio-player-wrapper audio"),function(){this.pause()})};this.showQuestions=function(){var b=quizOperator.getCurrentQuestion();if(null===b||quizOperator.askedQuestions.length==quizOperator.questionsPerQuiz)if(isAssessmentTest){if(assessmentOperator.moveToNextSubtype()){var a=assessmentOperator.getCurrentPartNumber(),c=assessmentOperator.getCurrentSkillSubtype(),d=quizOperator.testResultId;partNumber=a;skillSubtype=c;quizOperator=new QuizOperator(partNumber);quizOperator.testResultId=d;console.log("move to next assessment subtype: subtype = "+skillSubtype+", part = "+partNumber);quizOperator.startQuiz()}}else quizOperator.showQuizResultSummary();else{isAssessmentTest?(a=assessmentOperator.getPrevSubtypesMcqsCount()+quizOperator.countAskedMcqs()+1,b instanceof McqGroup?(c=a+"-"+(a+b.mcqs.length-1),a=a+b.mcqs.length-1):c=a):c=a=quizOperator.getCurrentQuestionIndexInPracticeTest()+1;$(".quiz-progress").progressbar("value",a);$(".quiz-progress .ui-progressbar-value").html("<span class='progress-value'>"+c+" / "+quizOperator.questionsPerQuiz+"</span>");$(".total-score").html(quizOperator.customerTotalScore);$(".mcq-score-gained").html("");$(".mcq-score-gained").html("").removeClass("slideUp").css({visibility:"hidden",display:""});if(!b.isMcqGroup){if(1==quizOperator.partNumber||2==quizOperator.partNumber){1==quizOperator.partNumber?$(".content-wrapper img").on("load",function(){console.log("image loaded");questionOperator.part1ImageLoaded=!0;isLearningMode||null===questionOperator.part1QuizAudioObj||startTimer(b.testDuration,questionOperator.part1QuizAudioObj)}).attr("src",b.imageUrl):$("#part2-quiz .speaker-a-audio-wrapper").css("visibility","");null!==timer&&timer.destroy();if(isLearningMode)$(".part-quiz .audio-player-wrapper audio source").attr("src",b.audioUrl),$(".part-quiz .audio-player-wrapper audio").trigger("load"),$(".part-quiz .audio-player-wrapper .speed-adjustment-wrapper .speed-select").val(1);else if(1==quizOperator.partNumber||2==quizOperator.partNumber){if(1==quizOperator.partNumber){var e=$("#part1-quiz .prepare-time-before-listen");var f=$("#part1-quiz .time-in-secs");options_wrapper=$("#part1-quiz .options")}else e=$("#part2-quiz .prepare-time-before-listen"),f=$("#part2-quiz .time-in-secs"),options_wrapper=$("#part2-quiz .options");options_wrapper.hide();a=3;f.html(a);a=new Date(Date.parse(new Date)+1E3*a);var g=Date.parse(a);e.show();timeInterval=setInterval(function(){var a=g-Date.parse(new Date);a=Math.floor(a/1E3%60);0<a?f.html(a):(clearInterval(timeInterval),e.hide(),options_wrapper.show(),playSound(b.audioUrl,!0),f.html(""))},1E3)}else playSound(b.audioUrl,!0);$(".transcript").html("");$(".translate-label").hide();$(".translation").html("");$(".answer-explanation").html("").hide()}else 5==quizOperator.partNumber&&($("#part5-quiz .transcript").html(b.question),$("#part5-quiz .audio-icon").hide(),$(".translate-label").hide(),$(".translation").html(""),$(".answer-explanation").html("").hide(),$(".options > li").removeClass("explained"),$(".option-exp").html(""),$(".option-exp-wrapper").hide(),startTimer(b.testDuration));$(".options li.option").each(function(a){$(this).removeClass(ClassConsts.CORRECT_ANSWER_CLS+" "+ClassConsts.INCORRECT_ANSWER_CLS);a=$(this).attr("value");if(1==quizOperator.partNumber||2==quizOperator.partNumber)$(this).html(MsgConsts.OPTION+" "+a);else if(5==quizOperator.partNumber){var c=b.optionTranscripts;$(this).html($(this).attr("value")+". "+c[a][0])}});$(".options li.option").off("click");$(".options li.option").click(function(){questionOperator.respondToSelectedOption([$(this).attr("value")])})}else if(b.isMcqGroup){if(3==quizOperator.partNumber||4==quizOperator.partNumber)null!==timer&&timer.destroy(),isLearningMode?($("#part-mcqgroup-quiz .read-questions-instructions .audio-player-wrapper source").attr("src",b.audioUrl),$("#part-mcqgroup-quiz .read-questions-instructions .audio-player-wrapper audio").trigger("load"),$("#part-mcqgroup-quiz .read-questions-instructions").show(),$("#part-mcqgroup-quiz  .audio-player-wrapper .speed-adjustment-wrapper .speed-select").val(1)):(a=$(".web-click-to-play"),0<a.length?($("#part-mcqgroup-quiz .read-questions-instructions .first-part").html(MsgConsts.YOU_CAN_PLAY_AUDIO),a.hide()):$("#part-mcqgroup-quiz .read-questions-instructions .first-part").html(MsgConsts.AUDIO_WILL_BE_PLAYED),isMobileBrowser||$(".mcq-group-wrapper > li:nth-child(2)").css("width","60%"),a=20,$("#part-mcqgroup-quiz .read-questions-instructions .time-in-secs").html(a),$("#part-mcqgroup-quiz .read-questions-instructions").show(),a=new Date(Date.parse(new Date)+1E3*a),g=Date.parse(a),timeInterval=setInterval(function(){var a=g-Date.parse(new Date);a=Math.floor(a/1E3%60);0<a?$("#part-mcqgroup-quiz .read-questions-instructions .time-in-secs").html(a):(clearInterval(timeInterval),$("#part-mcqgroup-quiz .read-questions-instructions").hide(),playSound(b.audioUrl,!0),$("#part-mcqgroup-quiz .read-questions-instructions .time-in-secs").html(""),goToClassByScroll("quiz-header"))},1E3)),""!=b.imageUrl?$("#part-mcqgroup-quiz .p34-image").attr("src",b.imageUrl).show():$("#part-mcqgroup-quiz .p34-image").hide(),$("#part-mcqgroup-quiz .mcq-group-content").hide();else if(6==quizOperator.partNumber||7==quizOperator.partNumber||8==quizOperator.partNumber){$("#part-mcqgroup-quiz .read-questions-instructions").hide();a="";for(c=0;c<b.reading_texts.length;++c)d=b.reading_texts[c][0],0<d.length&&(a+=(0<c?"<p class='para-header'>PARAGRAPH "+(c+1)+"</p><hr class='faded para-sep' />":"")+"<div class='one-reading-text'>"+d+"</div>");$("#part-mcqgroup-quiz .mcq-group-content").html(a);$("#part-mcqgroup-quiz .mcq-group-content").show()}for(d=0;d<b.mcqs.length;d++){a=b.mcqs[d];for(var h='<div class="mcq-question">'+a.question+"</div>",k="",l,m=0;4>m;m++)c="ABCD"[m],l="mcq-"+d+"-option-"+c,k+='<li><input type="radio" id="'+
l+'" name="mcq-'+d+'-option" value="'+c+'"/><label for="'+l+'">('+c+") "+a.optionTranscripts[c][0]+"</label></li>";k='<ul class="options">'+k+"</ul>";$("#part-mcqgroup-quiz .mcqs-wrapper").append('<li id="mcq-'+d+'" class="mcq-wrapper">'+h+k+"</li>")}$(".answer-explanation").html("").hide();$("#part-mcqgroup-quiz .mcq-group-content-exp").hide();$("#part-mcqgroup-quiz .submit-answers").show();6!=quizOperator.partNumber&&7!=quizOperator.partNumber&&8!=quizOperator.partNumber||startTimer(b.testDuration);$("#part-mcqgroup-quiz .submit-answers").off("click");$("#part-mcqgroup-quiz .submit-answers").click(function(){for(var a=[],c=0;c<b.mcqs.length;c++)(ans=$("#part-mcqgroup-quiz #mcq-"+c+' input[type="radio"]:checked').val())||(ans=null),a.push(ans);$(this).hide();questionOperator.respondToSelectedOption(a)})}quizOperator.getCurrentQuestion().didWronglyTheLastTime?$(".did-wrongly-the-last-time-msg").css("display","inline"):$(".did-wrongly-the-last-time-msg").hide();$(".next-mcq-button").hide();$(".mcq-feedback-button, .mcq-notes-button, .ask-button").hide();$(".quiz-header").show();$(".content-wrapper").show();$(".quiz .question-options-wrapper").show();quizOperator.publicMode&&"undefined"!==typeof b.hintImageUrl&&""!=b.hintImageUrl&&($(".hint-wrapper, .show-hint-btn").show(),$("#part5-quiz").css("margin-bottom","0px"),$(".show-hint-btn").click(function(){$(".hint-wrapper .hint-image").attr("src",b.hintImageUrl).show();goToClassByScroll("hint-image");$(this).hide()}));goToClassByScroll("quiz-header")}};this.showQuestionsScoreGained=function(){var b=this.getQuestionScoreResult();console.log("score = "+b);if(null!==b){var a=0<=b?"+"+b:"-"+Math.abs(b);$(".mcq-score-gained").html(a).addClass("slideUp").toggle("bounce",3E3);quizOperator.customerTotalScore+=b;$(".total-score").html(quizOperator.customerTotalScore);quizOperator.getCurrentQuestion().isMcqGroup&&goToClassByScroll("quiz-header")}};this.getSubtringsIndexes=function(b,a,c){var d=Array.apply(null,Array(a.length)).map(Number.prototype.valueOf,-1),e,f;for(e=0;e<b.length;++e)for(f=0;f<a.length;++f)if(-1==d[f]){var g=a[f];var h=c[f];b.substring(e,e+g.length)==g&&(1==h?d[f]=e:c[f]=h-1)}return d};this.compare2AnnotatedVocabs=function(b,a){b=b.found_index;a=a.found_index;return b<a?-1:b>a?1:0};this.showAnnotatedVocabsAndQuestionTrans=function(){for(var b,a=[],c=[],d=quizOperator.getCurrentQuestion(),e=0;e<d.annotatedVocabsInfo.length;++e)b=d.annotatedVocabsInfo[e],a.push(b.occurrence_str),c.push(b.occurrence_position);a=this.getSubtringsIndexes(d.question,a,c);for(e=0;e<a.length;++e){var f=a[e];b=d.annotatedVocabsInfo[e];b.found_index=f}d.annotatedVocabsInfo.sort(this.compare2AnnotatedVocabs);b=d.question;e=d.questionTrans;c=$(".annotated-vocabs-wrapper .vocabs-listing");c.html("");var g={};for(g.i$1=d.annotatedVocabsInfo.length-1;0<=g.i$1;g={i$1:g.i$1},--g.i$1){var h=d.annotatedVocabsInfo[g.i$1];f=h.found_index;if(-1!=f){b=b.substring(0,f)+"<span class='vocab-def vocab-def-"+g.i$1+"' title='"+MsgConsts.CLICK_TO_VIEW_VOCAB_DEF+"'>"+h.occurrence_str+"<span class='target-tooltip'><img src='/static/LearningPlan/images/new/icon_question.png' alt='H\u01b0\u1edbng d\u1eabn'><span>K\u00edch v\u00e0o t\u1eeb <strong>"+
h.occurrence_str+"</strong><br/>(m\u00e0u xanh) \u0111\u1ec3 xem ngh\u0129a & ph\u00e1t \u00e2m</span></span></span>"+b.substring(f+h.occurrence_str.length);$("#part5-quiz > .transcript-wrapper .transcript").on("click",".vocab-def-"+g.i$1,function(a){return function(){$(".annotated-vocabs-wrapper .transcript .vocab-def-"+a.i$1).trigger("mouseenter");goTo$ElementByScroll($("#part5-quiz .annotated-vocabs-wrapper"))}}(g));f=h.occurrence_translation;null!=f&&(e=e.replace(f,"<span class='vocab-trans vocab-trans-"+
g.i$1+"'>"+h.occurrence_translation+"</span>"));var k=h.vocab_def,l='<li><span class="radio radio-'+g.i$1+'"></span><span class="vocab vocab-'+g.i$1+'">'+k.vocab+"</span>"+(null!=k.audio_us?'<div class="audio-icon" onclick="playSound(\''+k.audio_us+"'); $('.annotated-vocabs-wrapper .vocabs-listing .vocab-"+g.i$1+"').trigger('mouseenter')\"></div>":"")+' <span class="pos">['+k.pos+']</span> <span class="meaning">'+k.meaning+"</span>";null!=k.meaning_notes&&""!=k.meaning_notes&&(l+=' <span class="meaning">('+
k.meaning_notes+")</span>");null!=h.occurrence_notes&&""!=h.occurrence_notes&&(l+='<p class="notes">'+h.occurrence_notes+"</p>");l+="</li>";c.prepend(l);$("#part5-quiz .annotated-vocabs-wrapper .transcript").on({mouseenter:function(a){return function(){$(".annotated-vocabs-wrapper .vocab-def.selected, .annotated-vocabs-wrapper .vocab-trans.selected, .annotated-vocabs-wrapper .vocab.selected, .annotated-vocabs-wrapper .radio.selected").removeClass("selected");$(this).addClass("selected");$(".annotated-vocabs-wrapper .vocab-trans-"+
a.i$1+", .annotated-vocabs-wrapper .vocab-"+a.i$1+", .annotated-vocabs-wrapper .radio-"+a.i$1).addClass("selected")}}(g)},".vocab-def-"+g.i$1);if(null!=f)$("#part5-quiz .annotated-vocabs-wrapper .translation").on({mouseenter:function(a){return function(){$(".annotated-vocabs-wrapper .vocab-def.selected, .annotated-vocabs-wrapper .vocab-trans.selected, .annotated-vocabs-wrapper .vocab.selected, .annotated-vocabs-wrapper .radio.selected").removeClass("selected");$(this).addClass("selected");$(".annotated-vocabs-wrapper .vocab-def-"+
a.i$1+", .annotated-vocabs-wrapper .vocab-"+a.i$1+", .annotated-vocabs-wrapper .radio-"+a.i$1).addClass("selected")}}(g)},".vocab-trans-"+g.i$1);$("#part5-quiz .annotated-vocabs-wrapper .vocabs-listing").on({mouseenter:function(a){return function(){$(".annotated-vocabs-wrapper .vocab-def.selected, .annotated-vocabs-wrapper .vocab-trans.selected, .annotated-vocabs-wrapper .vocab.selected, .annotated-vocabs-wrapper .radio.selected").removeClass("selected");$(this).addClass("selected");$(".annotated-vocabs-wrapper .vocab-def-"+
a.i$1+", .annotated-vocabs-wrapper .vocab-trans-"+a.i$1+", .annotated-vocabs-wrapper .radio-"+a.i$1).addClass("selected")}}(g)},".vocab-"+g.i$1)}}$("#part5-quiz > .transcript-wrapper .translation").html(d.questionTrans);0<a.length&&($("#part5-quiz .transcript").html(b),$("#part5-quiz .annotated-vocabs-wrapper .transcript .target-tooltip").remove(),$("#part5-quiz .annotated-vocabs-wrapper .translation").html(e),$(".annotated-vocabs-wrapper").show())};this.updateOptionsAndShowTranslations=function(){var b,a,c=quizOperator.getCurrentQuestion();if(1==quizOperator.partNumber||2==quizOperator.partNumber){$(".options li.option").each(function(c){a=$(this).attr("value");$(this).hasClass(ClassConsts.CORRECT_ANSWER_CLS)||$(this).hasClass(ClassConsts.INCORRECT_ANSWER_CLS)?b=MsgConsts.CLICK_TO_REPLAY_OPTION:($(this).addClass(ClassConsts.INCORRECT_ANSWER_CLS),b=MsgConsts.CLICK_TO_PLAY_OPTION);$(this).html(b+" "+a)});if(""!=c.videoExpURL){var d=quizOperator.getVideoExpHtml(c.videoExpURL);$(".answer-explanation").html(d).show()}2==quizOperator.partNumber&&($("#part2-quiz .speaker-a-audio-wrapper").css("visibility","visible"),$("#part2-quiz .speaker-a-audio-wrapper .audio-icon").off("click"),$("#part2-quiz .speaker-a-audio-wrapper .audio-icon").click(function(){questionOperator.stopAllPlayingSounds();playSound(c.speakerAAudioUrl,!1,function(){questionOperator.playOptionAudioAndShowTranscript(c,c.answer)});$("#part2-quiz .speaker-a-transcript-wrapper .transcript").html(c.question);$("#part2-quiz .speaker-a-transcript-wrapper .translation").html(c.questionTrans)}))}else if(5==quizOperator.partNumber){var e=c.optionTranscripts,f,g;$(".options li.option").each(function(b){a=$(this).attr("value");$(this).hasClass(ClassConsts.CORRECT_ANSWER_CLS)?(f=e[a][0],f="<span class='filled-blank'>"+f+"</span>",c.question=c.question.replace(ValueConsts.BLANK_SYMBOL,f),$("#part5-quiz .transcript").html(c.question)):$(this).addClass(ClassConsts.INCORRECT_ANSWER_CLS);$(this).off("click");g=e[a][1];$(this).closest(".one-option-wrapper").find(".option-exp").html(g)});""!=e.A[1]&&""!=e.B[1]&&""!=e.C[1]&&""!=e.D[1]&&$(".option-exp-wrapper").css("display","inline-block");if(""!=c.answerExp){d=c.isMcqGroup?"mcq-group":"mcq";var h=c.answerExp;""!=c.videoExpURL&&(h=quizOperator.getVideoExpHtml(c.videoExpURL)+h);learnerQuestionsMsg=0<c.learnerQuestionsCount?'<a class="learner-quests-link" href="/questions/mcqs/'+c.id+'" target="_blank">'+c.learnerQuestionsCount+" gi\u1ea3i \u0111\u00e1p</a>":"";isAssessmentTest||(h+='<div class="learner-questions-wrapper">'+learnerQuestionsMsg+'&nbsp;<div class="mcq-feedback-button"data-mcqid="'+
c.id+'" data-type="'+d+'" title="K\u00edch \u0111\u1ec3 g\u1eedi th\u1eafc m\u1eafc c\u1ee7a b\u1ea1n v\u1ec1 c\u00e2u h\u1ecfi n\u00e0y"><img src="/static/ToeicTests/images/ask_questions_icon_in_exps.png" alt="G\u1eedi th\u1eafc m\u1eafc c\u1ee7a b\u1ea1n"/></div></div>');0<c.grammarLinksInfo.length&&(h+=quizOperator.getGrammarLinksHtml(c.grammarLinksInfo));$("#part5-quiz .answer-explanation").html(h).show()}else $("#part5-quiz .transcript-wrapper .translation").html('<div class="request-explanation-wrapper" id="'+
c.id+'-wrapper"><button id="'+c.id+'" class="request-explanation-btn" title="K\u00edch \u0111\u1ec3 \u0111\u1ec1 xu\u1ea5t gi\u1ea3i th\u00edch">\u0110\u1ec1 xu\u1ea5t gi\u1ea3i th\u00edch c\u00e2u n\u00e0y</button></div>'),$(".request-explanation-btn").click(sendExplanationRequest);this.showAnnotatedVocabsAndQuestionTrans();$("#part5-quiz .audio-icon").off("click");""!=c.audioUrl?($("#part5-quiz .question-audio").css("display","inline-block"),$("#part5-quiz .question-audio").click(function(){$(this).hasClass("not-available")&&$(this).removeClass("not-available");questionOperator.stopAllPlayingSounds();playSound(c.audioUrl,!1,function(){})})):$("#part5-quiz .question-audio").hide();$("#part5-quiz .question-options-wrapper .audio-icon").each(function(){var a=$(this).closest("ul").find(".option").attr("value");""!=c.optionAudios[a]?($(this).hasClass("not-available")&&$(this).removeClass("not-available"),$(this).click(function(){questionOperator.stopAllPlayingSounds();var a=$(this).closest("ul").find(".option").attr("value");playSound(c.optionAudios[a],!1,function(){})})):$(this).addClass("not-available")});$("#part5-quiz .question-options-wrapper .audio-icon").show()}else if(c.isMcqGroup){isMobileBrowser||$(".mcq-group-wrapper > li:nth-child(2)").css("width","50%");if(3==quizOperator.partNumber||4==quizOperator.partNumber)isLearningMode?$("#part-mcqgroup-quiz .mcq-group-content-exp .audio-player-wrapper").hide():($("#part-mcqgroup-quiz .audio-player-wrapper source").attr("src",c.audioUrl),$("#part-mcqgroup-quiz .audio-player-wrapper audio").trigger("load"),$("#part-mcqgroup-quiz .audio-player-wrapper").show(),$("#part-mcqgroup-quiz .audio-player-wrapper .speed-adjustment-wrapper .speed-select").val(1));else if(6==quizOperator.partNumber||7==quizOperator.partNumber||8==quizOperator.partNumber)$("#part-mcqgroup-quiz .mcq-group-content").html("").hide(),$("#part-mcqgroup-quiz .mcq-group-content-exp .audio-player-wrapper").hide();""!=c.videoExpURL&&(d=quizOperator.getVideoExpHtml(c.videoExpURL),$(".answer-explanation").html(d).show());d="";for(h=0;h<c.reading_texts.length;++h){var k=c.reading_texts[h][0];0<k.length&&(d+=(0<h?"<p class='para-header'>PARAGRAPH "+(h+1)+"</p><hr class='faded para-sep' />":"")+"<div class='one-reading-text'><div class='content-translation'>"+c.reading_texts[h][1]+"</div><div class='content-transcript'>"+k+"</div></div>")}$("#part-mcqgroup-quiz .mcq-group-content-exp .readings-content").html(d);var l;$("#part-mcqgroup-quiz .mcq-wrapper").each(function(b){l=c.mcqs[b];0<l.questionTrans.length&&$(this).children(".mcq-question").append('<span class="question-translation"> &rarr; '+
l.questionTrans+"</span>");e=l.optionTranscripts;$(this).children(".options").children("li").each(function(b){a=$(this).children('input[type="radio"]').attr("value");$(this).append('<span class="option-translation"> &rarr; '+e[a][1]+"</span>")});""!=l.answerExp&&$(this).append('<div class="explanation">'+l.answerExp+"</div>")});$(".mcq-group-wrapper .quote").click(function(){for(var a=null,b,c=$(this).attr("class").split(/\s+/),d=0;d<c.length;d++)if(b=c[d],"quote"!==b){a=b;break}b=a.replace("quote-","");a=$("."+b);$(".mcq-group-wrapper .located.highlighted").removeClass("highlighted");a.addClass("located highlighted");isMobileBrowser?goToClassByScroll(b):(b=$(".mcq-group-wrapper > li:nth-child(1)"),b.scrollTop(b.offset().top+a.position().top+20))});$("#part-mcqgroup-quiz .mcq-group-content-exp").show()}};this.showOptionTranscript=function(b,a){var c=b.optionTranscripts[a];b.answer==a?(b=ClassConsts.CORRECT_ANSWER_COLOR_CLS,a=ClassConsts.INCORRECT_ANSWER_COLOR_CLS):(b=ClassConsts.INCORRECT_ANSWER_COLOR_CLS,a=ClassConsts.CORRECT_ANSWER_COLOR_CLS);if(1==quizOperator.partNumber){var d=$(".transcript");var e=$(".translation");var f=$(".translate-label")}else 2==quizOperator.partNumber&&(d=$(".speaker-b-transcript-wrapper .transcript"),e=$(".speaker-b-transcript-wrapper .translation"),f=$(".speaker-b-transcript-wrapper .translate-label"));d.removeClass(a).addClass(b);d.html(c[0]);1!=quizOperator.partNumber||quizOperator.translateLabelClicked||questionOperator.autoShowAnswer?(f.hide(),e.html(c[1])):(e.html(""),f.off("click"),f.click(function(){$(this).hide();e.html(c[1]);quizOperator.translateLabelClicked=!0}),f.show())};this.playOptionAudioAndShowTranscript=function(b,a){console.log("play audio of option "+a);this.showOptionTranscript(b,a);this.stopAllPlayingSounds();var c=$(".options li.option[value='"+a+"']");c.html(MsgConsts.PLAYING);playSound(b.optionAudios[a],!1,function(){var d=quizOperator.getCurrentQuestion();d&&d.id==b.id&&c.html(MsgConsts.CLICK_TO_REPLAY_OPTION+" "+a)})};this.markOption=function(b,a){if(b.isMcqGroup){this.customerAnswers=a;for(var c,d,e,f,g=0;g<b.mcqs.length;g++)c=b.mcqs[g],d=a[g],f=(e=d==c.answer)?'<img class="correct-icon" src="/static/ToeicTests/images/correct_answer_icon.png" />':'<img class="wrong-icon" src="/static/ToeicTests/images/wrong_answer_icon.png" />',$("#mcq-"+g+"-option-"+c.answer).siblings("label").addClass("correct-option"),null!=d?($customerOption=$("#mcq-"+g+"-option-"+d),$customerOption.closest("li").append(f),e||$customerOption.siblings("label").addClass("wrong-option")):$('<p class="no-answer-msg error">'+MsgConsts.NO_OPTION_SELECTED+"</p>").insertAfter("#mcq-"+g+" .mcq-question");this.questionAnswered=!0}else c=$(".options li.option[value='"+a+"']"),a==b.answer?(this.autoShowAnswer||playSound(PathConsts.CORRECT_ANS_SOUND_URL,!1),c.hasClass(ClassConsts.CORRECT_ANSWER_CLS)||c.addClass(ClassConsts.CORRECT_ANSWER_CLS),this.questionAnswered||c.effect("pulsate","slow"),this.questionAnswered=!0):(1!=quizOperator.partNumber&&2!=quizOperator.partNumber&&playSound(PathConsts.WRONG_ANS_SOUND_URL,!1),c.hasClass(ClassConsts.INCORRECT_ANSWER_CLS)||c.addClass(ClassConsts.INCORRECT_ANSWER_CLS),-1===$.inArray(a[0],this.wrongAnswers)&&this.wrongAnswers.push(a[0]))};this.respondToSelectedOption=function(b){var a=quizOperator.getCurrentQuestion();0==questionOperator.customerAnswers.length&&(questionOperator.timeOut?a.isMcqGroup||(questionOperator.customerAnswers=[null]):questionOperator.customerAnswers=b);if(this.questionAnswered)1!=quizOperator.partNumber&&2!=quizOperator.partNumber||this.playOptionAudioAndShowTranscript(a,b[0]);else{this.markOption(a,b);if(this.questionAnswered){console.log("mcq now answered");1!=quizOperator.partNumber&&2!=quizOperator.partNumber&&3!=quizOperator.partNumber&&4!=quizOperator.partNumber||this.stopAllPlayingSounds();null!=timer&&timer.stop();this.showQuestionsScoreGained();this.updateOptionsAndShowTranslations();quizOperator.publicMode||quizOperator.sendCurrentQuestionAnswerToServer();$(".next-mcq-button").show();$(".mcq-notes .mcq-notes-button").attr("id","notes-"+a.id);$(".mcq-feedback .mcq-feedback-button").attr("data-mcqid",a.id);var c=a.isMcqGroup?"mcq-group":"mcq";$(".mcq-feedback .mcq-feedback-button").attr("data-type",c);$(".mcq-notes .mcq-notes-button").attr("data-type",c);$(".mcq-notes .mcq-notes-button").attr("data-testid",quizOperator.testResultId);$(".mcq-feedback-button, .mcq-notes-button, .ask-button").show()}1==quizOperator.partNumber||2==quizOperator.partNumber?this.audioFinished?this.playOptionAudioAndShowTranscript(a,b[0]):console.log("audio not finished => don't play option audio"):(3==quizOperator.partNumber||4==quizOperator.partNumber||6==quizOperator.partNumber||7==quizOperator.partNumber||8==quizOperator.partNumber)&&$("#part-mcqgroup-quiz .mcqs-wrapper").find("*").prop("disabled",!0);this.questionAnswered||(3!=this.wrongAnswers.length||1!=quizOperator.partNumber&&5!=quizOperator.partNumber)&&(2!=quizOperator.partNumber||2!=this.wrongAnswers.length)||questionOperator.answerQuestion()}}}
function startQuiz(){isAssessmentTest&&(partNumber=assessmentPartNumbers[0],skillSubtype=assessmentSkillSubtypes[0]);quizOperator=new QuizOperator(partNumber);quizOperator.testResultId=practiceTestResultId;quizOperator.publicMode=null!==publicMcqInfo;if(quizOperator.publicMode)quizOperator.publicMcqDataDesc=publicMcqInfo.publicMcqDataDesc,quizOperator.publicMcqDataCode=publicMcqInfo.publicMcqDataCode,quizOperator.isGrammarApp=publicMcqInfo.isGrammarApp,quizOperator.minGrammarScoreToPass=publicMcqInfo.minScoreToPass,quizOperator.customerPublicQuizScore=publicMcqInfo.customerQuizScore,quizOperator.addThisQuizScore=publicMcqInfo.addThisQuizScore,quizOperator.scoreCounts=publicMcqInfo.scoreCounts,quizOperator.customerTotalScore=0;else if(isAssessmentTest){for(var b,a=partNumber,c=0;c<assessmentQuestions.length;++c){partNumber=assessmentPartNumbers[c];for(var d=0;d<assessmentQuestions[c].length;++d)b=assessmentQuestions[c][d],question=b.isMcqGroup?new McqGroup(b):new Mcq(b),assessmentQuestions[c][d]=question}assessmentOperator=new AssessmentOperator(assessmentQuestions,assessmentQuestionsWeights,assessmentSkillSubtypes,assessmentPartNumbers);partNumber=a}quizOperator.startQuiz()}$(document).ready(function(){autoStartPracticeTest?($(".lessons-links").hide(),startQuiz()):($(".practice-test-playfield").hide(),$(".lessons-links .start-test").click(function(){$(".lessons-links").hide();$(".practice-test-playfield").show();startQuiz()}))});function playSoundHelper(b,a,c){a&&!isLearningMode&&$(".test-timer").html("Loading audio...");soundManager.createSound({id:b,url:b,autoLoad:!1,autoPlay:!1,onload:function(){if(a){this.pause();var c=quizOperator.getCurrentQuestion();console.log("audio loaded, audio duration = "+soundManager.getSoundById(b).duration+", test duration from server = "+c.testDuration);var e=soundManager.getSoundById(b).duration;e=null!==e&&0<e?e/1E3:c.testDuration;if(c.isMcqGroup)e+=TimeConsts.TEST_DURATION_EXTRA_SECS_FOR_MCQ_GROUPS;else if(e+=TimeConsts.TEST_DURATION_EXTRA_SECS_FOR_SINGLE_MCQS,1==quizOperator.partNumber||2==quizOperator.partNumber)e+=TimeConsts.TEST_DURATION_EXTRA_EXTRA_SECS_FOR_PART_1_2;c.testDuration=e;console.log("final test duration used = "+e);1==quizOperator.partNumber?questionOperator.part1ImageLoaded?(console.log("image loaded =, now play sound"),questionOperator.part1QuizAudioObj=null,startTimer(e,this)):(questionOperator.part1QuizAudioObj=this,$(".test-timer").html("Loading image...")):startTimer(e,this)}},onfinish:function(){a&&(questionOperator.audioFinished=!0);null!==c&&c()}}).play()}function webClickToPlayMainAudio(b){var a=!1,c=$(".web-click-to-play");0<c.length&&(c.show(),$(".web-click-to-play").click(function(){playSoundHelper(b,!0,null);c.remove()}),a=!0);return a}function playSound(b,a,c){if(a&&(clickRegistered=webClickToPlayMainAudio(b)))return;"undefined"===typeof a&&(a=!1);"undefined"===typeof c&&(c=null);playSoundHelper(b,a,c)}
function startTimer(b,a){null!==timer&&timer.destroy();$(".test-timer").html("");isLearningMode||(timer=initializeTimer($(".test-timer"),b),timer.start());"undefined"!==typeof a&&null!==a&&a.play();isLearningMode||timer.addListener(function(a,b,e){0==e&&(questionOperator.timeOut=!0,questionOperator.answerQuestion())})}
function initializeTimer(b,a){b.data("timer",a);60<a?(a=!0,b.css("width","240px")):(a=!1,b.css("width","120px"));var c=TimeConsts.TIME_CIRLCE_DEFAULT_SETTINGS;c.time.Minutes.show=a;return b.TimeCircles(c)}function escapeHtml(b){var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return b.replace(/[&<>"']/g,function(b){return a[b]})};