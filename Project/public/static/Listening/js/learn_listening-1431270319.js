var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(c.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");function PathConsts(){}PathConsts.LISTENING_URL="index.html";PathConsts.CORRECT_ANS_SOUND_URL="../static/ToeicTests/audios/correct_answer_sound.mp3";PathConsts.WRONG_ANS_SOUND_URL="../static/ToeicTests/audios/wrong_answer_sound.mp3";function ClassConsts(){}ClassConsts.BLANK_SYMBOL_CLS="blank-symbol";ClassConsts.CONGRATS_MSG_CLS="congrats-msg";ClassConsts.CORRECT_ANSWER_CLS="correct-answer";ClassConsts.INCORRECT_ANSWER_CLS="incorrect-answer";ClassConsts.CORRECT_ANSWER_INDEX="correct-ans-index";function MsgsToCustomer(){}MsgsToCustomer.CONGRATS="Congratulations!";MsgsToCustomer.PLS_TRY_AGAIN="Not correct yet :( Please try again.";MsgsToCustomer.LISTEN_TO_WORD_AUDIO="No worry! B\u1ea1n k\u00edch v\u00e0o loa c\u1ee7a t\u1eeb \u0111\u1ec3 nghe ph\u00e1t \u00e2m c\u1ee7a t\u1eeb \u0111\u00f3";MsgsToCustomer.VIEW_SENTENCE_TRANS="D\u1ef1a v\u00e0o ngh\u0129a c\u1ee7a c\u00e2u, \u0111o\u00e1n t\u1eeb?";MsgsToCustomer.VIEW_ANSWER="Th\u1eadt ti\u1ebfc. Ti\u1ebfp t\u1ee5c c\u1ed1 g\u1eafng b\u1ea1n nh\u00e9!";function ImgConsts(){}ImgConsts.WORD_AUDIO_ICON_HTML='<img src="/static/ToeicTests/images/audio_icon_blue.png" class="word-audio-icon" />';var exOperator=null,preload=new createjs.LoadQueue(!1),ExOperator=function(){this.exs=[];this.weeklyScore=this.totalScore=this.exsPerRound=this.roundId=this.level=this.levelGrade=this.levelBloods=this.curRoundPosition=this.requiredRoundsCount=null;this.showRoundIntro=!1;this.correctExCount=this.wrongExCount=this.curExIndex=0;this.$nextBtn=$(".next-button");this._$allSections=$(".result-msg, .recommendations, .level-info, .ex-wrapper, .feedback, .next-btn");this.startTraining=function(){console.log("start training");this.hideAllSections();this.fetchExsFromServer();this.$nextBtn.on("click",function(){exOperator.startEx()});$(".view-game-instructions").on("click",function(){console.log("instr clicked");var a={maxHeight:600,buttons:[{text:"Ok",icon:"ui-icon-heart",click:function(){$(this).dialog("close")}}],position:{my:"top",at:"center"}};isMobileBrowser||(a.minWidth=640);$("#game-instructions").dialog(a)})};this.hideAllSections=function(){this._$allSections.hide();this.$nextBtn.hide()};this.showAllSections=function(){this._$allSections.show();this.$nextBtn.show()};this.startEx=function(){this.showRoundIntro?(this.hideAllSections(),$(".quiz-progress").hide(),$roundIntro=$(".round-intro"),$roundIntro.find(".level").html(this.level),$roundIntro.find(".cur-round").html(this.curRoundPosition),$roundIntro.show(),goTo$ElementByScroll($(".game-title")),setTimeout(function(){$roundIntro.effect("pulsate",{times:3}).toggle("shake",{percent:300,distance:40},function(){exOperator.showRoundIntro=!1;exOperator.startEx()})},500)):this.curExIndex<this.exs.length&&this.curExIndex<this.exsPerRound?(console.log("cur ex index = "+this.curExIndex),$(".quiz-progress").progressbar("value",this.curExIndex+1),$(".quiz-progress .ui-progressbar-value").html("<span class='progress-value'>"+(this.curExIndex+1)+" / "+this.exsPerRound+"</span>"),this.exs[this.curExIndex].start(),this.curExIndex++):this.exs.length<this.exsPerRound?0<this.exs.length?(console.log("continue to fetch from server"),this.fetchExsFromServer()):this.showNoMoreExMsg():this.showQuizSummary()};this.showQuizSummary=function(){console.log("show quiz summary");exOperator.hideAllSections();if(this.curRoundPosition<this.requiredRoundsCount){var a=$(".quiz-summary.level-in-progress");a.find(".completed-rounds").html(this.curRoundPosition);a.find(".level").html(this.level);a.find(".next-round").html(this.curRoundPosition+1);exOperator.updateLevelBloodsHtml()}else a=$(".quiz-summary.level-completed"),a.find(".level").html(this.level),a.find(".next-level").html(this.level+1);a.find(".correct-count").html(this.correctExCount);a.find(".total-count").html(this.correctExCount+this.wrongExCount);$(document).find("*").off();a.find(".continue-learning").first().click(function(){a.hide();$(".feedback").hide();exOperator=new ExOperator;exOperator.startTraining()});$(document).keydown(function(c){if(13==c.which)return a.find(".continue-learning").first().click(),!1});goToClassByScroll("quiz-progress");a.show()};this.showGameOverMsg=function(){console.log("show game over msg");exOperator.hideAllSections();var a=$(".game-over-summary");a.find(".completed-rounds").html(this.curRoundPosition-1);a.find(".required-rounds").html(this.requiredRoundsCount);a.find(".level").html(this.level);$(document).find("*").off();$(".game-over-summary .continue-learning").click(function(){$(".game-over-summary, .feedback").hide();exOperator=new ExOperator;exOperator.startTraining()});$(document).keydown(function(a){if(13==a.which)return $(".game-over-summary .continue-learning").click(),!1});goToClassByScroll("quiz-progress");$(".game-over-summary").show()};this.showCompletedListeningProgram=function(){exOperator.hideAllSections();$(".completed-listening-program").show();setTimeout(function(){blinkText($("#cont-p3"),300,3)},5E3)};this.showLoginToContinueMsg=function(){exOperator.hideAllSections();$(".login-to-continue").show()};this.showConfirmEmailMsg=function(){exOperator.hideAllSections();$(".confirm-email-to-continue").show()};this.showBuyAccountMsg=function(){exOperator.hideAllSections();$(".buy-account-to-continue").show()};this.showNoMoreExMsg=function(){exOperator.hideAllSections();$(".no-more-ex").show()};this.updateLevelBloodsHtml=function(a){var c=$(".level-bloods");c.html("");for(var b=1;b<=this.levelBloods;++b)c.append('<img src="/static/LearningPlan/images/new/icon_fire.png" alt="S\u1ee9c l\u1ef1c" class="blood">');if("undefined"!==typeof a&&0>a){var d=$(".subtracted-blood");d.html("-1").show();d.animate({backgroundColor:"#FB843C"},4E3,function(){d.css({"background-color":"#fff"})})}};this.updateScoresHtml=function(a){var c=$(".level-info");c.find(".total-score").first().html(this.totalScore);if(0<a){var b=c.find(".added-score");b.html("+1").show();b.animate({backgroundColor:"#33abe5"},1500,function(){b.css({"background-color":"#fff"})})}};this._updateLevelInfoAfterFetchingData=function(a){this.roundId=a.round_id;this.level=a.level;this.levelGrade=a.level_grade;this.levelBloods=a.level_bloods;this.curRoundPosition=a.cur_round_position;this.requiredRoundsCount=a.required_rounds_count;this.weeklyScore=a.weekly_score;this.totalScore=a.total_score;a=$(".level-info");a.find(".level").first().html(this.level);a.find(".level-grade").first().html(this.levelGrade);a.find(".cur-round").first().html(this.curRoundPosition);a.find(".required-rounds").first().html(this.requiredRoundsCount);a.find(".weekly-score").first().html(this.weeklyScore);a.find(".total-score").first().html(this.totalScore);this.updateLevelBloodsHtml();a.show()};this.fetchExsFromServer=function(){console.log("start fetching");$.ajax({url:PathConsts.LISTENING_URL+"get-exs/",type:"POST",dataType:"json",data:{},success:function(a){$(".loading-msg").hide();if(a.completed_all)exOperator.showCompletedListeningProgram();else{var c=a.login_to_continue;if(void 0!==c&&c)exOperator.showLoginToContinueMsg();else if(c=a.confirm_email_to_continue,console.log("confirmEmailToContinue = "+c),void 0!=c&&c)exOperator.showConfirmEmailMsg();else if(c=a.buy_account_to_continue,void 0!=c&&c)exOperator.showBuyAccountMsg();else{exOperator.exsPerRound=a.exs_per_round;$(".quiz-progress").progressbar({max:exOperator.exsPerRound});$(".quiz-progress").show();exOperator._updateLevelInfoAfterFetchingData(a);exOperator.showRoundIntro=a.show_round_intro;a=a.exs;console.log("exs data");console.log(a);for(c=0;c<a.length;++c)exOperator.exs.push(new Exercise(a[c]));exOperator.startEx()}}},error:function(a,c,b){console.log(a.responseText)}})};this.saveExResult=function(a){2<=a.wrongAnswers.length?(this.wrongExCount+=1,--this.levelBloods,this.updateLevelBloodsHtml(-1)):(this.correctExCount+=1,this.weeklyScore+=1,this.totalScore+=1,this.updateScoresHtml(1));$.ajax({url:PathConsts.LISTENING_URL+"save-ex/",type:"POST",dataType:"json",data:{ex_id:a.sentId,round_id:exOperator.roundId,wrong_answers:JSON.stringify(a.wrongAnswers)},success:function(a){"error"in a&&console.log("Error = "+a.error)},error:function(a,b,d){console.log(a.responseText)}});0>=this.levelBloods&&this.showGameOverMsg()};this.wait=function(a){for(var c=(new Date).getTime(),b=c;b<c+a;)b=(new Date).getTime()}},Exercise=function(a){this.sentId=a[0];this.audioUrl=a[1];this.audioText=a[2];this.audioTextTrans=a[3];this.hiddenWord=a[4];this.hiddenWordAudioUrl=a[5];preload.loadFile(this.audioUrl);preload.loadFile(this.hiddenWordAudioUrl);this.wrongAnswers=[];this.exCompleted=!1;this._stopSoundById=function(a){a=soundManager.getSoundById(a);"undefined"!==typeof a&&null!=a&&a.stop()};this._stopAllSounds=function(){this._stopSoundById(this.audioUrl);this._stopSoundById(this.hiddenWordAudioUrl)};this.stopAllSoundsAndPlayThisAudio=function(a,b){this._stopAllSounds();$("#customer-ans").focus();a.animate({backgroundColor:"#87C52E",borderRadius:"50%"});playSoundWithCallBack(b,onFinishFunc=function(){a.animate({backgroundColor:"#fff"},0)})};this.showAndHighlightMsg=function(a,b){goTo$ElementByScroll(a);a.html(b).addClass(ClassConsts.CONGRATS_MSG_CLS).effect("pulsate","slow")};this._showInstructionMsg=function(a){goToClassByScroll("result-msg");$(".result-msg").html(a)};this._showRecommendationsMsg=function(a,b){goToClassByScroll("recommendations");$(".recommendations").html(b).addClass("success-msg").show()};this.start=function(){var a=this;a._stopAllSounds();$(".subtracted-blood").stop(!0,!0);exOperator.showAllSections();$(".level-info .added-score").hide();var b=$(".ex-wrapper"),d=b.find(".audio-icon");d.off("click");d.on("click",function(){a.stopAllSoundsAndPlayThisAudio(d,a.audioUrl)});b.find(".audio-text").html(a.audioText);b.find(".text-trans").html("");b.find("#customer-ans").val("").focus();$("#customer-ans").show();$("#submit-customer-ans").off("click");$("#submit-customer-ans").show().on("click",function(){a.checkCustomerAns()});exOperator.$nextBtn.hide();$(".recommendations").html("").removeClass("success-msg");$(".result-msg").html("");$(document).off("keydown");$(document).keydown(function(c){if(32==c.which)return d.click(),!1;13==c.which&&a.checkCustomerAns()});$(".quiz-progress").show();goToClassByScroll("quiz-progress");b.show();var e=$(".web-click-to-play");0<e.length?(e.show(),e.find(".instructions").effect("pulsate","slow"),e.click(function(){e.remove();d.show();d.click()})):d.click()};this.checkCustomerAns=function(){var a=this;if(a.exCompleted)exOperator.$nextBtn.click();else{var b=$(".ex-wrapper"),d=b.find("#customer-ans");console.log("hidden word = "+a.hiddenWord);var e=d.val().toLowerCase();$blankWrapper=b.find("."+ClassConsts.BLANK_SYMBOL_CLS);var f=a.wrongAnswers.length;if(e==a.hiddenWord.toLowerCase())$("#customer-prev-ans").hide(),$blankWrapper.html('<span class="answer">'+a.hiddenWord+"</span>"),a.showAndHighlightMsg($(".result-msg"),MsgsToCustomer.CONGRATS),console.log("wrong count = "+
f),d="",1!=f&&(2==f?d='<p>N\u1ebfu vi\u1ec7c k\u1ebft n\u1ed1i \u00e2m trong c\u00e2u \u0111\u00e3 khi\u1ebfn b\u1ea1n kh\u00f4ng nghe \u0111\u01b0\u1ee3c</p><a href="https://giasutoeic.com/tieng-anh-giao-tiep/noi-am-trong-tieng-anh/?r=gstoeic" target="_blank">H\u1ecdc th\u00eam v\u1ec1 n\u1ed1i \u00e2m \u1edf \u0111\u00e2y</a>':3==f&&(d="B\u1ea1n ch\u00fa \u00fd ph\u00e1t \u00e2m c\u1ee7a t\u1eeb n\u00e0y b\u1ea1n nh\u00e9!")),""!=d&&a._showRecommendationsMsg(b,d),b.find(".text-trans").html(a.audioTextTrans),a.exCompleted=!0;else if(a.wrongAnswers.push(e),f=a.wrongAnswers.length,console.log("wrong count = "+f),$("#customer-prev-ans").html(e).show(),1==f)a._showInstructionMsg(MsgsToCustomer.PLS_TRY_AGAIN),d.val(""),b.find(".audio-icon").click();else if(2==f){a._showInstructionMsg(MsgsToCustomer.LISTEN_TO_WORD_AUDIO);$blankWrapper.html(ImgConsts.WORD_AUDIO_ICON_HTML);var g=$(".word-audio-icon");g.on("click",function(){a.stopAllSoundsAndPlayThisAudio(g,a.hiddenWordAudioUrl)});g.click();$(document).keydown(function(a){if(57==a.which)return $(".word-audio-icon").click(),!1});d.val("")}else 3==f?(a._showInstructionMsg(MsgsToCustomer.VIEW_SENTENCE_TRANS),b.find(".text-trans").html(a.audioTextTrans),d.val("")):4==f&&(a._showInstructionMsg(MsgsToCustomer.VIEW_ANSWER),$blankWrapper.html('<span class="answer">'+a.hiddenWord+"</span>"),a.exCompleted=!0);console.log("ex completed? = "+a.exCompleted);a.exCompleted&&(exOperator.saveExResult(a),$("#submit-customer-ans").hide(),exOperator.$nextBtn.show())}}};$(document).ready(function(){exOperator=new ExOperator;exOperator.startTraining()});